\usepackage[english]{babel}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{amssymb,amsmath}
\usepackage[english]{cleveref}
\usepackage{geometry}
\usepackage{titling}
\usepackage[inline]{enumitem}
\usepackage{setspace}
\usepackage{fancyhdr}
\usepackage{csquotes}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{ebproof}
\usepackage[makeroom]{cancel}
\usepackage{subcaption}
\usepackage{makecell}
\usepackage{adjustbox}
\usepackage{rotating}
\usepackage{xurl}
\usepackage{natbib}

\fancypagestyle{plain}{
	\fancyhf{}
	\fancyfoot[RE,LO]{\leftmark}
	\fancyfoot[LE,RO]{\thepage}
	\renewcommand{\footrulewidth}{1pt}
}

\fancypagestyle{fancy}{
	\fancyhf{}
	\fancyhead[CE,CO]{\rightmark}
	\fancyfoot[RE,LO]{\leftmark}
	\fancyfoot[LE,RO]{\thepage}
	\renewcommand{\headrulewidth}{1pt}
	\renewcommand{\footrulewidth}{1pt}
	\setlength{\headheight}{14.49998pt}
	\addtolength{\topmargin}{-2.49998pt}
}

\pagestyle{fancy}

\newcommand{\acknowledgementsname}{Acknowledgements}

\newcommand{\school}[1]{\def\theschool{#1}}
\newcommand{\programme}[1]{\def\theprogramme{#1}}
\newcommand{\contestsector}[1]{\def\thecontestsector{#1}}
\newcommand{\scientificsector}[1]{\def\thescientificsector{#1}}
\newcommand{\coordinator}[1]{\def\thecoordinator{#1}}
\newcommand{\supervisor}[1]{\def\thesupervisor{#1}}
\newcommand{\cycle}[1]{\def\thecycle{#1}}
\newcommand{\examyear}[1]{\def\theexamyear{#1}}
\newcommand{\keywords}[1]{\def\thekeywords{#1}}

\newcommand{\unnumberedchap}[1]{\chapter*{\centering#1}\addcontentsline{toc}{chapter}{#1}}

\newenvironment{abstract}{\unnumberedchap{\abstractname}}{\par\bigskip\noindent{\small\textbf{Keywords:} \thekeywords}}
\newenvironment{acknowledgements}{\unnumberedchap{\acknowledgementsname}}{\par{\small\begin{flushright}\theauthor, \today\end{flushright}}}
\newenvironment{dedication}{\chapter*{}\begin{flushright}\itshape}{\normalfont\end{flushright}}
\newenvironment{inlinelist}{\begin{enumerate*}[label=\emph{(\roman{*})}]}{\end{enumerate*}}

\newcommand{\sep}{$\cdot$~}

\newcommand{\chapterWithoutNumber}[1]{\chapter*{#1}\addcontentsline{toc}{chapter}{#1}}

\newcommand{\finalpart}[1]{\part*{#1}\addcontentsline{toc}{part}{#1}}

\let\oldbibliography\bibliography
\renewcommand{\bibliography}[1]{
	\oldbibliography{#1}
    \label{chap:bibliography}
    \addcontentsline{toc}{chapter}{\bibname}
}

\def\themainlinespacing{1}
\newcommand{\mainlinespacing}[1]{\def\themainlinespacing{#1}}
\let\oldmainmatter\mainmatter
\renewcommand{\mainmatter}{
	\oldmainmatter
	% \onehalfspacing % https://tex.stackexchange.com/questions/30073/why-is-the-linespread-factor-as-it-is
	\setstretch{\themainlinespacing}
}

\let\oldbackmatter\backmatter
\renewcommand{\backmatter}{
	\oldbackmatter
	% \onehalfspacing % https://tex.stackexchange.com/questions/30073/why-is-the-linespread-factor-as-it-is
	\setstretch{1}
}

\newcommand{\mypapers}[2][chapter]{
	\begin{flushright}\tiny
		This #1 contains contributions from the following works of ours: \cite{#2}
	\end{flushright}
}

\newcommand{\mystudentsthesis}[3][chapter]{
    \begin{flushright}\tiny
        This #1 contains contributions from the following #2 thesis: \cite{#3}, which we supervised
    \end{flushright}
}

\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1.}}
\newcommand{\emptyparagraph}{\oldparagraph*{}}

\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1.}}
\newcommand{\emptysubparagraph}{\oldsubparagraph*{}}

\setlist[description]{leftmargin=2\parindent,labelindent=\parindent}

\newcommand{\footnoteref}[1]{{\normalfont\textsuperscript{\ref{#1}}}}

\newcommand{\frontispiece}{
	\newgeometry{margin=0.8in}
	\begin{titlepage}
		\centering
		\large
		\textbf{\theschool}
		\\
		\noindent\hrulefill
		\vspace{0.4cm}

		\Large
		\theprogramme
        \\
        \thecycle{} Ciclo

		\Huge
		\vspace{3cm}
		\textbf{
			\thetitle
		}

		\large
		\vspace{3cm}
		Settore Concorsuale:
		\\
		\textsc{\thecontestsector}
		\\\vspace{0.5cm}
		Settore Scientifico Disciplinare:
		\\
		\textsc{\thescientificsector}

		\vspace{3cm}
		%
		\begin{minipage}[t]{0.64\textwidth}
			\begin{flushleft}
				\textit{Coordinatore Dottorato}
				\\
				\textbf{Prof. \thecoordinator}
				\\
				\vspace{0.4cm}
				\textit{Supervisore}
				\\
				\textbf{Prof. \thesupervisor}
			\end{flushleft}
		\end{minipage}
		%
		\begin{minipage}[t]{0.34\textwidth}
			\begin{flushright}
				\textit{Candidato}
				\\
				\textbf{\theauthor}
			\end{flushright}
		\end{minipage}
		\\

		\vfill
		\noindent\hrulefill
		\vspace{0.3cm}
		\Large


		Esame Finale Anno \theexamyear
	\end{titlepage}
	\restoregeometry
}